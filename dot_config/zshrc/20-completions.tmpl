#!/bin/bash

{{ if eq .chezmoi.os "darwin" -}}
if (( ${+commands[brew]} )); then
  fpath+="$(brew --prefix)/share/zsh/site-functions"
  fpath+="$(brew --prefix)/share/zsh-completions"
fi
{{ end -}}

# asdf
if (( ${+commands[asdf]} )); then
  fpath=(${HOME}/.asdf/completions $fpath)
fi

# pipenv
if (( ${+commands[pipenv]} )); then
  eval "$(_PIPENV_COMPLETE=zsh_source pipenv)"
fi

# pip
if (( ${+commands[pip]} )); then
  eval "$(pip completion --zsh)"
fi

# pip
if (( ${+commands[comfy]} )); then
  autoload -Uz compinit

  # Define custom completion for comfy
  # Ensure that _comfy_completion is defined after compinit
  _comfy_completion() {
    eval $(env _TYPER_COMPLETE_ARGS="${words[1,$CURRENT]}" _COMFY_COMPLETE=complete_zsh comfy)
  }

  # Bind the completion function to the comfy command
  compdef _comfy_completion comfy

  # Other configurations (e.g., aliases, prompt, etc.)
  zstyle ':completion:*' menu select
fi

# chezmoi
if (( ${+commands[chezmoi]} )); then
  eval "$(chezmoi completion zsh)"
fi

# 1password
if (( ${+commands[op]} )); then
    eval "$(op completion zsh)"
fi

# awscli
if (( ${+commands[aws]} )); then
    complete -C '/usr/local/bin/aws_completer' aws
fi

# kubectl
if (( ${+commands[kubectl]} )); then
    source <(kubectl completion zsh)
fi
